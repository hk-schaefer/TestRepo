<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Hartmut Schaefer" />

<meta name="date" content="2024-03-31" />

<title>Statistical inference with the GSS data</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TEST My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="02_stat_inf_project.html">Project 2</a>
</li>
<li>
  <a href="Exercises_Chapt_08.html">Project 3 (draft)</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical inference with the GSS
data</h1>
<h4 class="author">Hartmut Schaefer</h4>
<h4 class="date">2024-03-31</h4>

</div>


<div id="setup" class="section level2">
<h2>Setup</h2>
<div id="load-packages" class="section level4">
<h4>Load packages</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)       <span class="co"># ------------------- data exploration, visualization</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(statsr)          <span class="co"># ------------------- Course Stat R package</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(data.table)      <span class="co"># ------------------- table calculation</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)    <span class="co"># ------------------- additional color pallets</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(patchwork)       <span class="co"># ------------------- additional visualization tool</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(moments)         <span class="co"># ------------------- package to calculate Skewness</span></span></code></pre></div>
</div>
<div id="load-data" class="section level4">
<h4>Load data</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;~/R/TestRepo/Data/gss.Rdata&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="part-1-data" class="section level2">
<h2>Part 1: Data</h2>
<div id="the-general-social-survey-gss-data-set-1972-2012"
class="section level4">
<h4>The General Social Survey (GSS) Data set (1972-2012)</h4>
<p><strong>General objective of GSS</strong></p>
<p>Since 1972, the General Social Survey (GSS) has been monitoring
societal change and studying the growing complexity of American
society.</p>
<p>The GSS aims to gather data on contemporary American society in order
to monitor and explain trends and constants in attitudes, behaviors, and
attributes; to examine the structure and functioning of society in
general as well as the role played by relevant subgroups</p>
<p>This extract of the General Social Survey (GSS) Cumulative File
1972-2012 provides a sample of selected indicators in the GSS with the
goal of providing a convenient data resource for students learning
statistical reasoning using the R language. <a
href="https://d3c33hcgiwev3.cloudfront.net/_8abbe344133a7a8c98cfabe01a5075c2_gss.html?Expires=1711843200&amp;Signature=NA9UOEFUJSPiJ2yEK-jMs1r0FM6Mv8fO21UDJWkCAqVDAm5DRUMfD~xUJpTSQHU-AWefK9vtHT5T90ffPXmBPR1tpSYX~e~KVBX2LujrYxSzvIPngO-r8Ah1S8BRa9XL9NH-GIc9o5gigSf8beum93T1gfKMNTDmJncao9ebNAg_&amp;Key-Pair-Id=APKAJLTNE6QMUY6HBC5A">Link</a><br />
<br />
</p>
<p><strong>Data survey methodology</strong></p>
<p>The GSS is intended for people (18 and above) living in US homes. The
GSS sample is derived from an <strong>area probability
methodology</strong> that <strong>selects respondents at
random</strong>. As a result, participants in the GSS come from a wide
spectrum of urban, suburban, and rural areas. <strong>Participation in
the study is purely voluntary</strong>. With <strong>only a few thousand
people questioned</strong> in the original study, every <strong>person
chosen can contribute significantly</strong> to its findings.<br />
</p>
<p>The data were collected by <strong>personal face-to-face
interviews</strong>, <strong>telephone interviews</strong> and
<strong>paper-based questionnaires</strong> (1972-2001) and from 2002
shifted to <strong>computer-assisted personal interviewing
methods</strong> <a
href="https://en.wikipedia.org/wiki/General_Social_Survey">Link</a><br />
<br />
</p>
</div>
<div id="brief-data-exploration" class="section level4">
<h4>Brief data exploration</h4>
<p><strong>Sample size by year</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Distribution of sample size</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>gss <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year))<span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sample size per year (1972 - 2012)&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year of survey&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Sample size&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-2-1.png" width="672" /><br />
</p>
<p>Sample sizes in 1972-1993 are of about equal size 1500. From 1994
only every second year was sampled with a sample size of about 2800 in
1994-2004. In 2006 the sample size jumped to 4500. In 2008-2012 the
sample size returned back to around 2000 .<br />
<br />
</p>
<p><strong>Distribution by age and gender</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Distribution of age by gender</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>prop_sex <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_sex =</span> n<span class="sc">/</span><span class="fu">sum</span>(n))</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>prop_sex</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   sex        n p_sex
##   &lt;fct&gt;  &lt;int&gt; &lt;dbl&gt;
## 1 Male   25084 0.441
## 2 Female 31775 0.559</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>gss <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age))<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill=</span>sex), <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sample distribution for age by gender (1972-2012)&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Age&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sex, <span class="at">nrow=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;nmone&quot;</span>)</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-3-1.png" width="672" /><br />
Proportion in sex over all samples is 56% female and 44% male. The
distributions of age are both right skewed for female and male. There is
a small bias towards female due to their higher sample size, which is
different from the population distribution (p = 0.5)<br />
<br />
</p>
</div>
<div id="summary" class="section level4">
<h4>Summary:</h4>
<p><strong>Can the sample statistics be generalized to the US
population?</strong><br />
</p>
<ul>
<li>All <em>samples were taken randomly</em>. However, since
participation in the study was purely voluntary, we have to account for
a certain <em>voluntary bias</em>.<br />
</li>
<li>There is a <em>variability in sample size between the years</em>.
Results from sample statistics cannot be generalized over the whole time
span from 1972 to 2012. Instead it <em>should be generalized only to a
respective year</em>. All sample sizes are above 1000 and <em>can
therefore be generalized to the population</em>.<br />
</li>
<li>The age distribution of the participants is right skewed for both
genders, but without any extreme outliers and can be generalized.<br />
<br />
<br />
<br />
<br />
</li>
</ul>
</div>
</div>
<div id="part-2-research-questions" class="section level2">
<h2>Part 2: Research Questions</h2>
<div id="objective" class="section level4">
<h4>Objective</h4>
<p>Objective of the 2nd course project is to apply learned contents of
statistical inference:</p>
<ul>
<li>Conditions for statistical inference applying The Central Limit
Theorem<br />
</li>
<li>Confidence interval and hypothesis testing<br />
</li>
<li>Inference for categorical data<br />
</li>
<li>Inference for numerical data<br />
</li>
</ul>
<p>According to these objectives the following research questions were
chosen from the given data set:<br />
</p>
<p>Part I: Inference for categorical data<br />
<br />
Research question 1: Inference for a single proportion (z-test)<br />
Research question 2: Inference for difference of two proportions
(z-test)<br />
Research question 3: Testing for independence (Chi-square test)<br />
<br />
</p>
<p>Part II: Inference for numerical data<br />
<br />
Research question 4: Inference for difference of two means
(t-test)<br />
Research question 5: Inference for differences of many means: ANOVA
test<br />
<br />
Abbreviations:<br />
</p>
<ul>
<li>CI = confidence interval</li>
<li>HT = hypothesis test<br />
<br />
<br />
<br />
</li>
</ul>
</div>
</div>
<div id="part-3-categorical-data" class="section level2">
<h2>Part 3: Categorical data</h2>
<div id="single-proportion" class="section level3">
<h3>1. Single proportion</h3>
<div id="research-question-1-attitude-towards-suicide"
class="section level4">
<h4>Research Question 1: Attitude towards suicide</h4>
<p>One of the question in the GSS survey was the attitude towards
suicide if someone has an incurable disease. Do the majority of
Americans approve the view on suicide in this case?<br />
</p>
<ol style="list-style-type: lower-alpha">
<li>Calculate the proportion and its <strong>confidence
interval</strong> at a 95% confidence level<br />
</li>
<li>Does the data provide strong evidence that the majority of people
approve the view on suicide in this case. Apply a <strong>hypothesis
test</strong> with a significance level of 5%<br />
</li>
<li>Run the CI and HT calculation over all samples and identify a
trend<br />
</li>
</ol>
<p>We will use the following variable:<br />
</p>
<ul>
<li><code>suicide1</code>(2 levels): Suicide if incurable disease,
single variable<br />
</li>
</ul>
<p><br />
</p>
</div>
<div id="exploratory-data-analysis-eda" class="section level4">
<h4>Exploratory data analysis (EDA)</h4>
<p>Prepare the data set</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Select required variables</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">select</span>(year, suicide1)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">str</span>(gss_select)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    57061 obs. of  2 variables:
##  $ year    : int  1972 1972 1972 1972 1972 1972 1972 1972 1972 1972 ...
##  $ suicide1: Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: NA NA NA NA NA NA NA NA NA NA ...</code></pre>
<p>Check number of levels in <code>suicide</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Check number of levels in categorical variable</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">group_by</span>(suicide1) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   suicide1     n
##   &lt;fct&gt;    &lt;int&gt;
## 1 Yes      15924
## 2 No       12902
## 3 &lt;NA&gt;     28235</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Plot number of levels in categorical variable</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(suicide1)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> suicide1)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Has the right of suicide if incurable disease (1972-2012)&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Approve&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Calculate proportions for each level</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Calculate proportion for each level per year</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># n_total: total number of sample</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># n_resp: number of responses who approve (success)</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># p_hat: sample proportion for approval (estimate)</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>gss_result_01 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(suicide1)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="fu">group_by</span>(year, suicide1) <span class="sc">%&gt;%</span> </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_resp =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_total =</span> <span class="fu">sum</span>(n_resp),</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>         <span class="at">p_hat =</span> n_resp <span class="sc">/</span> <span class="fu">sum</span>(n_resp)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>  <span class="fu">filter</span>(suicide1 <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">head</span>(gss_result_01)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
## # Groups:   year [6]
##    year suicide1 n_resp n_total p_hat
##   &lt;int&gt; &lt;fct&gt;     &lt;int&gt;   &lt;int&gt; &lt;dbl&gt;
## 1  1977 Yes         578    1475 0.392
## 2  1978 Yes         588    1483 0.396
## 3  1982 Yes         754    1768 0.426
## 4  1983 Yes         760    1530 0.497
## 5  1985 Yes         675    1480 0.456
## 6  1986 Yes         758    1420 0.534</code></pre>
<p><br />
<br />
</p>
</div>
<div id="a-inference---confidence-interval" class="section level4">
<h4>1a) Inference - Confidence Interval</h4>
<p><strong>Condition check</strong>:<br />
1. Independence of observations: Samples were taken randomly (see Part
1) =&gt; OK<br />
2. Success-failure condition (SF condition):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># check SF condition for CI</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># p_hat : sample proportion (used as approximation for true proportion p)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># SF condition: n_total * p_hat &gt; 10 &amp; n_total * (1 - p_hat) &gt; 10 == TRUE</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>gss_result_01 <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SF_CI =</span> <span class="fu">ifelse</span>(n_total<span class="sc">*</span>p_hat<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                          n_total<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat)<span class="sc">&gt;</span><span class="dv">10</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>           )</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>gss_result_01</span></code></pre></div>
<pre><code>## # A tibble: 21 × 6
## # Groups:   year [21]
##     year suicide1 n_resp n_total p_hat SF_CI
##    &lt;int&gt; &lt;fct&gt;     &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
##  1  1977 Yes         578    1475 0.392 TRUE 
##  2  1978 Yes         588    1483 0.396 TRUE 
##  3  1982 Yes         754    1768 0.426 TRUE 
##  4  1983 Yes         760    1530 0.497 TRUE 
##  5  1985 Yes         675    1480 0.456 TRUE 
##  6  1986 Yes         758    1420 0.534 TRUE 
##  7  1988 Yes         492     946 0.520 TRUE 
##  8  1989 Yes         469     957 0.490 TRUE 
##  9  1990 Yes         519     873 0.595 TRUE 
## 10  1991 Yes         579     987 0.587 TRUE 
## # ℹ 11 more rows</code></pre>
<p>Independence and SF conditions are met. We can, therefore, conclude
the sample proportion p_hat is nearly normal distributed and can apply
the z-statistics to the confidence level calculation.<br />
</p>
<p><br />
<strong>Calculate SE and CI</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Calculate SE and CI</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># se_ci = standard error for confidence interval</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># moe = margin of error: z_star * se_ci</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># lower = lower margin of p_hat</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co"># upper = upper margin of p_hat</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>gss_result_01 <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">filter</span>(SF_CI <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">se_ci =</span> <span class="fu">sqrt</span>(p_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat)<span class="sc">/</span>n_total),</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>           <span class="at">moe =</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>se_ci,</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>           <span class="at">lower =</span> p_hat <span class="sc">-</span> moe,</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>           <span class="at">upper =</span> p_hat <span class="sc">+</span> moe</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>          )</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>gss_result_01_view <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1977</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="dv">2012</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  <span class="fu">select</span>(year, p_hat, se_ci, moe, lower, upper)</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>gss_result_01_view</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
## # Groups:   year [2]
##    year p_hat  se_ci    moe lower upper
##   &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  1977 0.392 0.0127 0.0249 0.367 0.417
## 2  2012 0.590 0.0139 0.0272 0.563 0.617</code></pre>
<p><br />
<strong>Conclusion: </strong> We are 95% confident that the true
proportion of the American population who approved suicide in case of
incurable disease was in 1977 between 36.7% and 41.6%, and in 2012
between 56.3% and 61.7%.<br />
<br />
<br />
</p>
</div>
<div id="b-inference---hypothesis-test" class="section level4">
<h4>1b) Inference - Hypothesis Test</h4>
<p>Null hypothesis (H0): There is no strong evidence that the American
population approves suicide in case of incurable disease.</p>
<p>Alternative hypothesis (Ha): There is a strong evidence that the
American population approves suicide in case of incurable disease.<br />
</p>
<p>This can be formulated as:<br />
</p>
<ul>
<li>H0: p = 0.5 (there is a 50:50 chance)<br />
</li>
<li>Ha: p &gt; 0.5 (more people approve suicide due to incurable
disease)<br />
</li>
<li>Significance level: alpha = 0.05 (5%)</li>
</ul>
<p>We will carry out a one-sided z-Test<br />
<br />
</p>
<p><strong>Condition check</strong>:<br />
1. Independence of observations: Samples were taken randomly (see Part
1) =&gt; OK<br />
2. Success-failure condition (SF condition for hypothesis test)</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># check SF condition for HT</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># p0 : true proportion (null value) given that H0 is true</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># SF condition: n_total * p0t &gt; 10 &amp; n_total * (1 - p0) &gt; 10 == TRUE</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># check SF condition for HT</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>gss_result_01 <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SF_HT =</span> <span class="fu">ifelse</span>(n_total<span class="sc">*</span>p0<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span> n_total<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">&gt;</span><span class="dv">10</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  )</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>gss_result_01_view <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">select</span>(year, n_total, p_hat, SF_HT)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>gss_result_01_view</span></code></pre></div>
<pre><code>## # A tibble: 21 × 4
## # Groups:   year [21]
##     year n_total p_hat SF_HT
##    &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
##  1  1977    1475 0.392 TRUE 
##  2  1978    1483 0.396 TRUE 
##  3  1982    1768 0.426 TRUE 
##  4  1983    1530 0.497 TRUE 
##  5  1985    1480 0.456 TRUE 
##  6  1986    1420 0.534 TRUE 
##  7  1988     946 0.520 TRUE 
##  8  1989     957 0.490 TRUE 
##  9  1990     873 0.595 TRUE 
## 10  1991     987 0.587 TRUE 
## # ℹ 11 more rows</code></pre>
<p>Independence and SF conditions are met. We can, therefore, conclude
the sample proportion p_hat is nearly normal distributed and that we can
apply the z-statistics for the hypothesis test.<br />
</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co"># H0:       p0 = 0.5 (there is no clear winner, 50:50)</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># Ha:       p &gt; 0.5  (true proportion is greater than 0.5)</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># alpha:    significance level (usually 0.05, i.e. 5%)</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co"># Type:     one sided test</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># p:        true proportion</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co"># p0:       true proportion given that H0 is true</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># p_hat:    observed proportion from sample</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co"># se_ht:    standard error given that H0 is true (use p0 instead)</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># Z:        z-statistic used to calculate the p-value</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co"># p_value:  probability of observed or more extreme values given H0 is true</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co"># decision: p_value &lt; alpha : Reject H0, in favor of Ha</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co"># decision: p_value &gt;= alpha: Fail to reject H0</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>gss_result_01 <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>  <span class="fu">filter</span>(SF_HT <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se_ht =</span> <span class="fu">sqrt</span>(p0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">/</span>n_total),</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>         <span class="at">Z =</span> (p_hat <span class="sc">-</span> p0)<span class="sc">/</span>se_ht,</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>         <span class="at">p_value =</span> <span class="fu">pnorm</span>(Z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>         <span class="at">test_result =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha, <span class="st">&quot;There is a majority&quot;</span>, <span class="st">&quot;No majority&quot;</span>)</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>  )</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>gss_result_01_view <span class="ot">&lt;-</span> gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>  <span class="fu">select</span>(year, p_hat, SF_HT, se_ht, Z, p_value, test_result)</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>gss_result_01_view</span></code></pre></div>
<pre><code>## # A tibble: 21 × 7
## # Groups:   year [21]
##     year p_hat SF_HT  se_ht      Z      p_value test_result        
##    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;              
##  1  1977 0.392 TRUE  0.0130 -8.31  1            No majority        
##  2  1978 0.396 TRUE  0.0130 -7.97  1.00         No majority        
##  3  1982 0.426 TRUE  0.0119 -6.18  1.00         No majority        
##  4  1983 0.497 TRUE  0.0128 -0.256 0.601        No majority        
##  5  1985 0.456 TRUE  0.0130 -3.38  1.00         No majority        
##  6  1986 0.534 TRUE  0.0133  2.55  0.00542      There is a majority
##  7  1988 0.520 TRUE  0.0163  1.24  0.108        No majority        
##  8  1989 0.490 TRUE  0.0162 -0.614 0.730        No majority        
##  9  1990 0.595 TRUE  0.0169  5.58  0.0000000117 There is a majority
## 10  1991 0.587 TRUE  0.0159  5.44  0.0000000262 There is a majority
## # ℹ 11 more rows</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> test_result, <span class="at">fill=</span>test_result))<span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">labs</span> (</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Hypothesis test: Approve suicide due to incurable disease in US?&quot;</span>,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;H0: no majority, Ha: majority, 1977-2012 (alpha = 5%)&quot;</span>,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Test results&quot;</span>,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;In number of years&quot;</span>)<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>),</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-12-1.png" width="672" /><br />
</p>
<p><strong>Conclusion: </strong> In 14 years out of 21 the data show
strong evidence that the majority of the population does approve suicide
in case of incurable disease, with an type 1 error of 5%. I.e we may
have made an error of 5% by rejecting the hypothesis but in fact the
null hypothesis is true.<br />
In 7 years out of 21 the data do not show strong evidence that the
majority of the population does approve suicide in case of incurable
disease<br />
<br />
</p>
</div>
<div id="c-inference---trend" class="section level4">
<h4>1c) Inference - Trend</h4>
<p>Visualizing the trend of population attitude towards suicide between
1977 to 2012:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>gss_result_01 <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year))<span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> p_hat<span class="sc">*</span><span class="dv">100</span>), <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lower<span class="sc">*</span><span class="dv">100</span>), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> upper<span class="sc">*</span><span class="dv">100</span>), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="fu">labs</span> (</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Attitude towards suicide due to incurable disease in US (1977-2012)&quot;</span>,</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Proportion with confidence interval in percent of sample population, (alpha = 5%)&quot;</span>,</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>,</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Precentage&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">2005</span>, <span class="at">y=</span><span class="dv">51</span>, <span class="at">label=</span><span class="st">&quot;approve&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">2005</span>, <span class="at">y=</span><span class="dv">49</span>, <span class="at">label=</span><span class="st">&quot;not approve&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-13-1.png" width="672" /><br />
<strong>Conclusion: </strong> In the years 1977 to 1989, except for
1986, the majority of the population did not approved suicide. Whereas,
from 1990 the majority does approve it.<br />
The approval rate for suicide increased from 39% to 69% between 1977 and
1994 then slightly decreased to 59% in 2012.<br />
The results of the confidence interval and hypothesis tests agree with
each other. I.e a “Fail to reject H0” result corresponds to a confidence
interval whose lower value is less or equal to 50%.<br />
<br />
</p>
<p><br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="difference-of-proportions" class="section level3">
<h3>2. Difference of proportions</h3>
<div
id="research-question-2-success-in-life-through-hard-work---belief-by-race"
class="section level4">
<h4>Research Question 2: Success in life through hard work - belief by
race</h4>
<p>Another question in the GSS survey is about the belief that hard work
leads to success in life. We like to find differences in belief between
the White and Non-white population. For this, we are going to test the
difference of two proportions.</p>
<ol style="list-style-type: lower-alpha">
<li>Calculate the proportion difference and <strong>confidence
interval</strong> at a 95% confidence level<br />
</li>
<li>Does the data provide strong evidence that there is a difference in
belief. Apply a <strong>hypothesis test</strong> with a significance
level of 5%<br />
</li>
<li>Run the CI and HT calculation over all samples and identify a
trend.<br />
</li>
</ol>
<p>We will use the following variables:<br />
</p>
<ul>
<li><code>getahead</code> (4 levels): Opinion of how people get ahead,
response variable<br />
</li>
<li><code>race</code> (3 levels): Race of respondent, explanatory
variable<br />
</li>
</ul>
<p><br />
</p>
</div>
<div id="exploratory-data-analysis-eda-1" class="section level4">
<h4>Exploratory data analysis (EDA)</h4>
<p><strong>Prepare the data set</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Select required variables</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">select</span>(year, race, getahead)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Remove NAs</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(race) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(getahead))</span></code></pre></div>
<p><br />
</p>
<p><strong>Inspect variables</strong></p>
<p>Variable <code>race</code></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Inspect variable race</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">group_by</span>(race) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
## # Groups:   race [3]
##   race      n
##   &lt;fct&gt; &lt;int&gt;
## 1 White 28317
## 2 Black  4955
## 3 Other  1705</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>race))<span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>    <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Distribution of race&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><br />
</p>
<p>Variable <code>getahead</code></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Inspect variable getahead</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">group_by</span>((getahead)) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
## # Groups:   (getahead) [4]
##   `(getahead)`     n
##   &lt;fct&gt;        &lt;int&gt;
## 1 Hard Work    23022
## 2 Both Equally  7834
## 3 Luck Or Help  4085
## 4 Other           36</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>getahead))<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Distr. of belief how to get ahead in life&quot;</span>)<span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-18-1.png" width="672" /><br />
</p>
<p><strong>Group categorical levels to meaningful
sub-categories</strong><br />
</p>
<p>Collapse categorical levels to end up with 2 levels per
variable.<br />
</p>
<ul>
<li>race: grouping “Black” and “Other” -&gt; “Non-white”<br />
</li>
<li>getahead: grouping “Both Equally”, “Luck Or Help”, and “Other” -&gt;
“Other”<br />
</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Collapsing levels</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>gss_select_fct <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co">#  filter(getahead != &quot;Both Equally&quot;) %&gt;%     ---------- In case to take out this level</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race_new =</span> <span class="fu">fct_collapse</span>(race,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>                            <span class="at">white =</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>),</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>                            <span class="at">non_white =</span> <span class="fu">c</span>(<span class="st">&quot;Black&quot;</span>, <span class="st">&quot;Other&quot;</span>)),</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>         <span class="at">getahead_new =</span> <span class="fu">fct_collapse</span>(getahead,</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>                            <span class="at">hard_work =</span> <span class="fu">c</span>(<span class="st">&quot;Hard Work&quot;</span>),</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>                            <span class="at">not_hard_work_alone =</span> <span class="fu">c</span>(<span class="st">&quot;Both Equally&quot;</span>, <span class="st">&quot;Luck Or Help&quot;</span>, <span class="st">&quot;Other&quot;</span>))</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  )</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="co"># Remove old levels</span></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>gss_select_fct <span class="ot">&lt;-</span> gss_select_fct <span class="sc">%&gt;%</span> </span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>  <span class="fu">select</span>(year, race_new, getahead_new)</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>gss_select_fct <span class="sc">%&gt;%</span> </span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>getahead_new))<span class="sc">+</span></span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>race_new))<span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Distribution of belief how to get ahead in life by race&quot;</span>,</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>,</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Opinion&quot;</span>,</span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">&quot;Race&quot;</span>)<span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-19-1.png" width="672" /><br />
</p>
<p><strong>Calculate proportions for each level</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Calculate proportion for each level per year</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co"># n_total: total number of sample</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co"># n_resp:  number of responses who believe in &quot;hard_work&quot; (success)</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="co"># p_hat:   sample proportion who believe in &quot;hard_work&quot; (estimate)</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_select_fct <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  <span class="fu">group_by</span>(year, race_new, getahead_new) <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_resp =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_total =</span> <span class="fu">sum</span>(n_resp),</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>         <span class="at">p_hat =</span> n_resp <span class="sc">/</span> <span class="fu">sum</span>(n_resp)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  <span class="fu">filter</span>(getahead_new <span class="sc">==</span> <span class="st">&quot;hard_work&quot;</span>)</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2012</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
## # Groups:   year, race_new [2]
##    year race_new  getahead_new n_resp n_total p_hat
##   &lt;int&gt; &lt;fct&gt;     &lt;fct&gt;         &lt;int&gt;   &lt;int&gt; &lt;dbl&gt;
## 1  2012 white     hard_work       671     972 0.690
## 2  2012 non_white hard_work       239     330 0.724</code></pre>
<p><br />
</p>
<p><strong>Pivot table so that each year is listed in one
row</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co"># Rearrange table so that races are listed in one row</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> race_new, <span class="at">values_from =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co"># simplify variable names</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  <span class="fu">select</span>(year,</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>         <span class="at">n_white =</span> n_total_white,</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>         n_resp_white,</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>         p_hat_white,</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>         <span class="at">n_non_white =</span> n_total_non_white,</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>         n_resp_non_white,</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>         p_hat_non_white)</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2012</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
## # Groups:   year [1]
##    year n_white n_resp_white p_hat_white n_non_white n_resp_non_white
##   &lt;int&gt;   &lt;int&gt;        &lt;int&gt;       &lt;dbl&gt;       &lt;int&gt;            &lt;int&gt;
## 1  2012     972          671       0.690         330              239
## # ℹ 1 more variable: p_hat_non_white &lt;dbl&gt;</code></pre>
<p><br />
</p>
<p><strong>Calculate difference of proportions and p_pool</strong></p>
<p><code>p_pool</code> is the weighted average of proportions and will
be used in hypothesis testing later.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># calculate difference of proportions and p_pool</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_hat_diff =</span> p_hat_white <span class="sc">-</span> p_hat_non_white,</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>         <span class="at">p_pool =</span> (p_hat_white<span class="sc">*</span>n_white <span class="sc">+</span> p_hat_non_white<span class="sc">*</span>n_non_white)<span class="sc">/</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>           (n_white <span class="sc">+</span> n_non_white)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>  )</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>  <span class="fu">select</span>(year, p_hat_diff, p_pool) <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2012</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
## # Groups:   year [1]
##    year p_hat_diff p_pool
##   &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1  2012    -0.0339  0.699</code></pre>
<p><br />
<br />
</p>
</div>
<div id="a-inference---confidence-interval-1" class="section level4">
<h4>2a) Inference - Confidence Interval</h4>
<p><strong>Condition check</strong>:<br />
1. Independence of observations: Samples were taken randomly (see Part
1) =&gt; OK<br />
2. Success-failure condition (SF condition):</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># check SF condition for CI</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="co"># p_hat_x : sample proportion for x (used as approximation for true proportion p)</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># SF cond1: n_total * p_hat_white &gt; 10 &amp; n_total * (1 - p_hat_white) &gt; 10 == TRUE</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="co"># SF cond2: n_total * p_hat_non_white &gt; 10 &amp; n_total * (1 - p_hat_non_white) &gt; 10 == TRUE</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SF_CI =</span> <span class="fu">ifelse</span>(n_white<span class="sc">*</span>p_hat_white<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>                 n_white<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat_white)<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>                 n_non_white<span class="sc">*</span>p_hat_non_white<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>                 n_non_white<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat_non_white)<span class="sc">&gt;</span><span class="dv">10</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>  )</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>  <span class="fu">group_by</span>(SF_CI) <span class="sc">%&gt;%</span> </span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   SF_CI     n
##   &lt;chr&gt; &lt;int&gt;
## 1 TRUE     24</code></pre>
<p>Independence and SF conditions are met for all years. We can,
therefore, conclude the sample proportions p_hat_white, p_hat_non_white,
and its difference p_hat_diff are nearly normal distributed and that we
can apply the z-statistics to the confidence level calculation.<br />
<br />
</p>
<p><strong>Calculate SE and CI for proportion difference</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Calculate SE and CI</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co"># se_ci = standard error for confidence interval</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co"># moe = margin of error: z_star * se_ci</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="co"># lower = lower margin of p_hat</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co"># upper = upper margin of p_hat</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  <span class="fu">filter</span>(SF_CI <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se_ci =</span> <span class="fu">sqrt</span>(p_hat_white<span class="sc">*</span>    (<span class="dv">1</span><span class="sc">-</span>p_hat_white)<span class="sc">/</span>    n_white <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>                      p_hat_non_white<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat_non_white)<span class="sc">/</span>n_non_white),</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>         <span class="at">moe =</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>se_ci,</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>         <span class="at">lower =</span> p_hat_diff <span class="sc">-</span> moe,</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>         <span class="at">upper =</span> p_hat_diff <span class="sc">+</span> moe,</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>  )</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>gss_result_02_view <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2012</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>  <span class="fu">select</span>(year, p_hat_diff, se_ci, moe, lower, upper)</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>gss_result_02_view</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
## # Groups:   year [1]
##    year p_hat_diff  se_ci    moe   lower  upper
##   &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1  2012    -0.0339 0.0287 0.0563 -0.0902 0.0224</code></pre>
<p><br />
<strong>Conclusion: </strong> We are 95% confident that the true
proportion difference between White and Non-white Americans who belief
that hard work leads to success is between -9.0% and 2.2% in 2012. I.e.
the true difference could be either negative or positive. Therefore,
there is no clear winner. This will be covered in the hypothesis
test.<br />
<br />
<br />
</p>
</div>
<div id="b-inference---hypothesis-test-1" class="section level4">
<h4>2b) Inference - Hypothesis Test</h4>
<p>Null hypothesis (H0): There is no strong evidence of a difference in
belief between White and Non-white American population that hard work
leads to success in life.<br />
</p>
<p>Alternative hypothesis (Ha): There is a strong evidence of a
difference in belief between White and Non-white American population
that hard work leads to success in life.<br />
</p>
<p>This can be formulated as:<br />
</p>
<ul>
<li>H0: p0_diff = p_white - p_non_white = 0 (there is no
difference)<br />
</li>
<li>Ha: p_diff = p_white - p_non_white != 0 (there is a
difference)<br />
</li>
<li>Significance level: alpha = 0.05 (5%)</li>
</ul>
<p>We will carry out a two-sided z-Test<br />
<br />
</p>
<p><strong>Condition check</strong>:<br />
1. Independence of observations: Samples were taken randomly (see Part
1) =&gt; OK<br />
2. Success-failure condition (SF condition for hypothesis test)</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># check SF condition for HT</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="co"># p_pool :      weighted proportion (estimate for p0) given that H0 is true</span></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="co"># SF cond1.:    n_white * p_pool &gt; 10 &amp; n_white * (1 - p_pool) &gt; 10 == TRUE</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="co"># SF cond2.:    n_non_white * p_pool &gt; 10 &amp; n_non_white * (1 - p_pool) &gt; 10 == TRUE</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SF_HT =</span> <span class="fu">ifelse</span>(n_white<span class="sc">*</span>p_pool<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>                        n_white<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_pool)<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>                        n_non_white<span class="sc">*</span>p_pool<span class="sc">&gt;</span><span class="dv">10</span> <span class="sc">&amp;</span></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>                        n_non_white<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_pool)<span class="sc">&gt;</span><span class="dv">10</span>, <span class="st">&quot;TRUE&quot;</span>, <span class="st">&quot;FALSE&quot;</span>)</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>  )</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>  <span class="fu">group_by</span>(SF_HT) <span class="sc">%&gt;%</span> </span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   SF_HT     n
##   &lt;chr&gt; &lt;int&gt;
## 1 TRUE     24</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>gss_result_02_view <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>  <span class="fu">select</span>(year, p_hat_white, p_hat_non_white, p_hat_diff, p_pool, SF_HT)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">View</span>(gss_result_02_view[<span class="dv">19</span><span class="sc">:</span><span class="dv">24</span>,])</span></code></pre></div>
<p>Independence and SF conditions are met for all years. We can,
therefore, conclude the sample proportion p_diff is nearly normal
distributed and that we can apply the z-statistics for the hypothesis
test.<br />
<br />
</p>
<p><strong>Hypothesis test</strong></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># Hypothesis test</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="co"># H0:       p0_diff  = 0 (there is no difference)</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a><span class="co"># Ha:       p_diff  != 0 (there is a difference)</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="co"># alpha:    significance level (usually 0.05, i.e. 5%)</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a><span class="co"># Type:     two-sided test</span></span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="co"># p_diff:   true proportion difference</span></span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a><span class="co"># p0_diff:  true proportion difference given that H0 is true</span></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="co"># p_hat_diff: observed proportion difference from sample</span></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a><span class="co"># se_ht:    standard error given that H0 is true (use p_pool instead)</span></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a><span class="co"># Z:        z-statistic used to calculate the p-value</span></span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="co"># p_value:  probability of observed or more extreme values given H0 is true</span></span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a><span class="co"># decision: p_value &lt; alpha : Reject H0, in favor of Ha</span></span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a><span class="co"># decision: p_value &gt;= alpha: Fail to reject H0</span></span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>p0_diff <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>gss_result_02 <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>  <span class="fu">filter</span>(SF_HT <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se_ht =</span> <span class="fu">sqrt</span>(p_pool<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_pool)<span class="sc">/</span>n_white <span class="sc">+</span></span>
<span id="cb46-22"><a href="#cb46-22" tabindex="-1"></a>                      p_pool<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_pool)<span class="sc">/</span>n_non_white),</span>
<span id="cb46-23"><a href="#cb46-23" tabindex="-1"></a>         <span class="at">Z =</span> (p_hat_diff <span class="sc">-</span> p0_diff)<span class="sc">/</span>se_ht,</span>
<span id="cb46-24"><a href="#cb46-24" tabindex="-1"></a>         <span class="at">p_value =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(Z), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb46-25"><a href="#cb46-25" tabindex="-1"></a>         <span class="at">test_result =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha, <span class="st">&quot;There is a difference&quot;</span>, <span class="st">&quot;No difference&quot;</span>)</span>
<span id="cb46-26"><a href="#cb46-26" tabindex="-1"></a>  )</span>
<span id="cb46-27"><a href="#cb46-27" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" tabindex="-1"></a>df_H0_reject <span class="ot">&lt;-</span> gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb46-29"><a href="#cb46-29" tabindex="-1"></a><span class="co">#  filter(test_result == &quot;There is a difference&quot;) %&gt;% </span></span>
<span id="cb46-30"><a href="#cb46-30" tabindex="-1"></a>  <span class="fu">select</span>(year, p_hat_diff, lower, upper, se_ht, Z, p_value, test_result)</span>
<span id="cb46-31"><a href="#cb46-31" tabindex="-1"></a>df_H0_reject</span></code></pre></div>
<pre><code>## # A tibble: 24 × 8
## # Groups:   year [24]
##     year p_hat_diff     lower  upper  se_ht     Z      p_value test_result      
##    &lt;int&gt;      &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;            
##  1  1973     0.0562 -0.0171   0.129  0.0365 1.54  0.124        No difference    
##  2  1974     0.0340 -0.0427   0.111  0.0387 0.878 0.380        No difference    
##  3  1976     0.160   0.0724   0.247  0.0434 3.69  0.000226     There is a diffe…
##  4  1977     0.0639 -0.0116   0.139  0.0379 1.69  0.0918       No difference    
##  5  1980     0.0344 -0.0480   0.117  0.0414 0.831 0.406        No difference    
##  6  1982     0.145   0.0951   0.196  0.0255 5.70  0.0000000122 There is a diffe…
##  7  1984     0.0442 -0.0251   0.113  0.0346 1.28  0.202        No difference    
##  8  1985     0.0750  0.000395 0.150  0.0369 2.03  0.0419       There is a diffe…
##  9  1987     0.0487  0.00138  0.0959 0.0239 2.04  0.0416       There is a diffe…
## 10  1988     0.0685 -0.0113   0.148  0.0396 1.73  0.0838       No difference    
## # ℹ 14 more rows</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Summary of HT</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="fu">group_by</span>(test_result) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   test_result               n
##   &lt;chr&gt;                 &lt;int&gt;
## 1 No difference            17
## 2 There is a difference     7</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Plot result</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> test_result, <span class="at">fill=</span>test_result))<span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">labs</span> (</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Hypothesis test: Hard work leads to success&quot;</span>,</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Difference in belief between White and Non-white Americans, 1973-2012 (alpha = 5%)&quot;</span>,</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>,</span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Test results&quot;</span>,</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;In number of years&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>),</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-27-1.png" width="672" /><br />
</p>
<p><strong>Conclusion: </strong> In 17 years out of 24 the data show no
strong evidence that there is a difference in belief between White and
Non-white Americans that hard work leads to success. In other words, we
have no strong evidence that being a white American increases or reduces
the belief that hard work leads to success in life.<br />
Only in 7 years out of 24 the data show a strong evidence that there is
a difference in belief between White and Non-white Americans that hard
work leads to success. In other words, we do have strong evidence that
being a white American increases or reduces the belief that hard work
leads to success in life<br />
<br />
<br />
</p>
</div>
<div id="c-inference---trend-1" class="section level4">
<h4>2c) Inference - Trend</h4>
<p>Visualizing the trend of population belief towards hard work:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># Plot trend of Confidence Intervals</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>gss_result_02 <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year))<span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> p_hat_diff<span class="sc">*</span><span class="dv">100</span>), <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lower<span class="sc">*</span><span class="dv">100</span>), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> upper<span class="sc">*</span><span class="dv">100</span>), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>  <span class="fu">labs</span> (</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Get ahead in life by hard work in US (1973-2012)&quot;</span>,</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Difference in belief between White and Non-White Americans (alpha = 5%)&quot;</span>,</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="co">#  subtitle = &quot;Proportion difference with confidence interval in percent of sample population (alpha=5%)&quot;,</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>,</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Precentage&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">1998</span>, <span class="at">y=</span><span class="dv">17</span>, <span class="at">label=</span><span class="st">&quot;White believe more&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">1998</span>, <span class="at">y=</span><span class="sc">-</span><span class="dv">10</span>, <span class="at">label=</span><span class="st">&quot;Non-White belive more&quot;</span>)<span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># mean(gss_result_02$moe)</span></span></code></pre></div>
<p><br />
<strong>Conclusion: </strong> Overall, the White group believes more
than the Non-White group, that hard work leads to success in life.
Because the proportion difference is in most cases positive:<br />
<br />
p_hat_diff = p_hat_white - p_hat_non_white &gt; 0<br />
Therefore: p_hat_white &gt; p_hat_non_white<br />
And <code>p_hat</code> is the proportion of belief on hard work<br />
</p>
<p>However, in most cases (17 out of 24) the difference is not
statistically significant, due to a large margin of error
(+/-6.8%)<br />
</p>
<p>The results of the confidence interval and hypothesis tests agree
with each other. I.e a “Fail to reject H0” result corresponds to a
confidence interval that does include 0.<br />
<br />
<br />
</p>
<p><br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="independence-test" class="section level3">
<h3>3: Independence test</h3>
<div id="resarch-question-3-political-party-vs.-education-degree"
class="section level4">
<h4>Resarch Question 3: Political party vs. education degree</h4>
<p>In this example, we want to answer the question of whether there is a
relationship between the preferred political party and the level of
education. Both variables are categorical variables with multiple
levels.</p>
<p>To test for a relationship we will conduct a <strong>Chi-square test
for independence</strong>. An introduction to this test can be found <a
href="https://leanpub.com/os">in the text book for this course,
OpenIntro Statistics, 4th edition, page 240</a><br />
</p>
<p>We will use the following variables:<br />
</p>
<ul>
<li><code>partyid</code>(8 levels): Political party affiliation,
response variable<br />
</li>
<li><code>degree</code> (5 levels): Respondents highest degree,
explanatory variable<br />
</li>
</ul>
<p>The Hypothesis test can be formulated as follows:<br />
</p>
<ul>
<li>H0: The political party preference <strong>is independent</strong>
from the education degree<br />
</li>
<li>Ha: The political party preference <strong>is not
independent</strong> from the education degree<br />
</li>
<li>Significance level: alpha = 5%<br />
<br />
</li>
</ul>
</div>
<div id="exploratory-data-analysis-eda-2" class="section level4">
<h4>Exploratory data analysis (EDA)</h4>
<p><strong>Prepare the data set</strong></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Select variables of interest</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  <span class="fu">select</span>(year, degree, partyid)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a><span class="co"># Check NA counts for each variable</span></span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(gss_select))</span></code></pre></div>
<pre><code>##    year  degree partyid 
##       0    1010     327</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Remove NAs</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(partyid) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(degree))</span></code></pre></div>
<p><br />
</p>
<p><strong>Inspect variables</strong></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Inspect category degree</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="fu">group_by</span>((degree)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
## # Groups:   (degree) [5]
##   `(degree)`         n
##   &lt;fct&gt;          &lt;int&gt;
## 1 Lt High School 11731
## 2 High School    29146
## 3 Junior College  3053
## 4 Bachelor        7962
## 5 Graduate        3862</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>degree))<span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Education degrees - levels&quot;</span>)<span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a><span class="co"># Inspect category partyid</span></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  <span class="fu">group_by</span>(partyid) <span class="sc">%&gt;%</span> </span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 8 × 2
## # Groups:   partyid [8]
##   partyid                n
##   &lt;fct&gt;              &lt;int&gt;
## 1 Strong Democrat     8885
## 2 Not Str Democrat   11801
## 3 Ind,Near Dem        6666
## 4 Independent         8327
## 5 Ind,Near Rep        4869
## 6 Not Str Republican  8889
## 7 Strong Republican   5477
## 8 Other Party          840</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>partyid))<span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">title =</span> <span class="st">&quot;Political party - levels&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-31-1.png" width="672" /><br />
</p>
<p><strong>Filter for 2012</strong></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="co"># Filter for year 2012</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>gss_select_2012 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2012</span>)</span></code></pre></div>
<p><br />
</p>
<p><strong>Group categorical levels of variable <code>partyid</code> to
meaningful sub-categories</strong><br />
</p>
<p>We will assign the 8 political party preferences to 3 main party
groups:<br />
</p>
<ul>
<li>Republican = {Strong Republican, Not Str Republican}<br />
</li>
<li>Independent = {Ind Near Dem, Independent, Ind Near Rep}<br />
</li>
<li>Democrat = {Strong Democrat, Not Str Democrat}<br />
<br />
</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="do">############################################################ Regroup levels</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a><span class="co">#  -------------------------------------------------------- Collapse levels</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>gss_select_fct <span class="ot">&lt;-</span> gss_select_2012 <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  <span class="fu">filter</span>(partyid <span class="sc">!=</span> <span class="st">&quot;Other Party&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">partyid2 =</span> <span class="fu">fct_collapse</span>(partyid,</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>                                 <span class="at">Republican =</span> <span class="fu">c</span>(<span class="st">&quot;Not Str Republican&quot;</span>,</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>                                                <span class="st">&quot;Strong Republican&quot;</span>),</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>                                 <span class="at">Independent =</span> <span class="fu">c</span>(<span class="st">&quot;Ind,Near Dem&quot;</span>,</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>                                                 <span class="st">&quot;Independent&quot;</span>,</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>                                                 <span class="st">&quot;Ind,Near Rep&quot;</span>),                               </span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>                                 <span class="at">Democrat =</span> <span class="fu">c</span>(<span class="st">&quot;Strong Democrat&quot;</span>,</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>                                              <span class="st">&quot;Not Str Democrat&quot;</span>)  </span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>                                 ),</span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>         <span class="at">degree2 =</span> degree <span class="sc">%&gt;%</span> <span class="fu">fct_rev</span>()</span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>  <span class="fu">select</span>(degree2, partyid2)</span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a><span class="co"># -------------------------------------------------- Reduce levels from 8 to 3</span></span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>gss_select_fct<span class="sc">$</span>partyid2 <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(gss_select_fct<span class="sc">$</span>partyid2)</span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a><span class="co"># --------------------------------------------------------------- Order levels</span></span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a>gss_select_fct<span class="sc">$</span>partyid2 <span class="ot">&lt;-</span> </span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a>  <span class="fu">factor</span>(gss_select_fct<span class="sc">$</span>partyid2, </span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Republican&quot;</span>,<span class="st">&quot;Democrat&quot;</span>,<span class="st">&quot;Independent&quot;</span>),</span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>         <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a></span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a>gss_select_fct <span class="sc">%&gt;%</span> </span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a>  <span class="fu">group_by</span>(partyid2) <span class="sc">%&gt;%</span> </span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   partyid2        n
##   &lt;ord&gt;       &lt;int&gt;
## 1 Republican    441
## 2 Democrat      697
## 3 Independent   761</code></pre>
<p><br />
</p>
<p><strong>Plot preferred party by education degree in
proportion</strong></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="do">############################################# Plot proportions party by degree</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>gss_select_fct <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>degree2))<span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>partyid2), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relationship between education degree and preferred party&quot;</span>,</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;US 2012, in proportion&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Party&quot;</span>,</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Education Degree&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Party (proportions)&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-34-1.png" width="672" /><br />
</p>
<p><strong>Create a 2-way-table (contingency table)</strong></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># ---------------------------------------------------- Create contingency table</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>gss_cont_table <span class="ot">&lt;-</span> <span class="fu">table</span>(gss_select_fct)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>gss_cont_table</span></code></pre></div>
<pre><code>##                 partyid2
## degree2          Republican Democrat Independent
##   Graduate               37       91          68
##   Bachelor              107      123         108
##   Junior College         35       58          52
##   High School           231      337         379
##   Lt High School         31       88         154</code></pre>
<p><br />
</p>
</div>
<div id="inference" class="section level4">
<h4>Inference</h4>
<p><strong>Check conditions</strong><br />
</p>
<ol style="list-style-type: decimal">
<li>Independence:<br />
</li>
</ol>
<ul>
<li>random sampling within each group: OK<br />
</li>
<li>random sampling between groups: OK<br />
</li>
<li>sample size &lt; 10% of population: OK<br />
</li>
<li>each case only contributes to one cell (assumed): OK<br />
<br />
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Sample size:<br />
</li>
</ol>
<ul>
<li>each cell size &gt; 5: OK<br />
</li>
</ul>
<p>All conditions are met and nearly normal distribution can be assumed.
Chi-square test statistic can be applied<br />
</p>
<p><strong>Chi-square test</strong></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="do">############################################################### Chi-square test</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="fu">table</span>(gss_select_fct<span class="sc">$</span>degree2, gss_select_fct<span class="sc">$</span>partyid2))</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>model</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  table(gss_select_fct$degree2, gss_select_fct$partyid2)
## X-squared = 62.212, df = 8, p-value = 1.713e-10</code></pre>
<p><br />
<strong>Conclusion</strong> The p-value is about zero. We therefore, can
reject H0. I.e. party preference is not independent from education
degree, with a p-value of nearly zero percent.<br />
</p>
<p>P-value: Probability of an observed value or more extreme than
X-squared = 62.2 given that H0 is true.<br />
<br />
<br />
</p>
<p><br />
<br />
<br />
<br />
</p>
</div>
</div>
</div>
<div id="part-4-numerical-data" class="section level2">
<h2>Part 4: Numerical data</h2>
<div id="difference-of-two-means" class="section level3">
<h3>4. Difference of two means</h3>
<div
id="research-question-4-attitude-towards-space-exploration-spending-by-education"
class="section level4">
<h4>Research question 4: Attitude towards space exploration spending by
education</h4>
<p>One of the question in the GSS survey deals with the attitude towards
government spending on space exploration (too little, too much). We want
to know if there is difference in the attitude due to average years of
education in 2010 to 2012. We assume that people with more years of
education may think that the gov. spending is too little. To proof this
claim we will conduct a hypothesis test and calculate the confidence
interval by t-statistic.</p>
<p>We will use the following variables:<br />
</p>
<ul>
<li><code>natspac</code>(categorical, 3 levels): Space exploration
program, response variable<br />
</li>
<li><code>educ</code> (numerical): Highest year of school completed,
explanatory variable<br />
</li>
</ul>
<p>Tasks:<br />
</p>
<ol style="list-style-type: lower-alpha">
<li>Calculate a summary statistic and a <strong>confidence
interval</strong> for the difference in means at a 95% confidence
level<br />
</li>
<li>Does the data provide strong evidence that Americans with more years
in education think that the government spending for space exploration is
too little. Apply a <strong>hypothesis test</strong> with a significance
level of 5%<br />
<br />
</li>
</ol>
</div>
<div id="exploratory-data-analysis-eda-3" class="section level4">
<h4>Exploratory data analysis (EDA)</h4>
<p>Prepare the data set</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co"># Prepare the data set</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="co"># ---------------------------------------------------------- Select variables</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span> </span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  <span class="fu">select</span>(year, educ, natspac) <span class="sc">%&gt;%</span> </span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(educ), <span class="sc">!</span><span class="fu">is.na</span>(natspac))</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a><span class="co"># ------------------------------------------------------ Select 2010 - 2012 data</span></span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2010</span><span class="sc">:</span><span class="dv">2012</span>))</span></code></pre></div>
<p><br />
</p>
<p><strong>Variable <code>natspac</code></strong></p>
<p>Check number of levels</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># Check number of levels in categorical variable</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  <span class="fu">group_by</span>(natspac) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   natspac         n
##   &lt;fct&gt;       &lt;int&gt;
## 1 Too Little    372
## 2 About Right   810
## 3 Too Much      656</code></pre>
<p>Since we only want to compare levels “too little” and “too much”
spending, we will remove level “About Right” from the data set.<br />
</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># Remove level &quot;About Right&quot; in  variable</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>gss_select2 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>natspac <span class="sc">==</span> <span class="st">&quot;About Right&quot;</span>) </span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  <span class="fu">group_by</span>(natspac) <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   natspac        n
##   &lt;fct&gt;      &lt;int&gt;
## 1 Too Little   372
## 2 Too Much     656</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># Drop factor levels from 3 to 2 in, required for plotting</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>gss_select2<span class="sc">$</span>natspac <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(gss_select2<span class="sc">$</span>natspac)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="co"># Plot distribution of &quot;too little&quot; vs. &quot;too much&quot;</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> natspac))<span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Attitude towards nat. space exploration funding&quot;</span>,</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(US in 2010-2012, sample size = 1028)&quot;</span>,</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Space exploration funding&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-40-1.png" width="672" /><br />
<br />
</p>
<p><strong>Summary statistics for variable
<code>educ</code></strong></p>
<p>Rename the group names:<br />
</p>
<ul>
<li>Group 1: respondent who replied with “too little”<br />
</li>
<li>Group 2: respondent who replied with “too much”<br />
<br />
</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># Summary statistics for variable &quot;educ&quot;</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>stat_descript <span class="ot">&lt;-</span> gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  <span class="fu">group_by</span>(natspac) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>            <span class="at">mean_edu =</span> <span class="fu">mean</span>(educ),</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>            <span class="at">sd_edu =</span> <span class="fu">sd</span>(educ),</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>            <span class="at">median_edu =</span> <span class="fu">median</span>(educ)</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>            )</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>stat_descript</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   natspac        n mean_edu sd_edu median_edu
##   &lt;fct&gt;      &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1 Too Little   372     14.5   2.77         14
## 2 Too Much     656     12.9   3.09         12</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>stat_descript <span class="ot">&lt;-</span> stat_descript <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> natspac, <span class="at">values_from =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>stat_descript <span class="ot">&lt;-</span> stat_descript <span class="sc">%&gt;%</span> </span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">n_1 =</span> <span class="st">&quot;n_Too Little&quot;</span>,</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>         <span class="at">n_2 =</span> <span class="st">`</span><span class="at">n_Too Much</span><span class="st">`</span>,</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>         <span class="at">mean_1 =</span> <span class="st">&quot;mean_edu_Too Little&quot;</span>,</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>         <span class="at">mean_2 =</span> <span class="st">`</span><span class="at">mean_edu_Too Much</span><span class="st">`</span>,</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>         <span class="at">sd_1 =</span> <span class="st">`</span><span class="at">sd_edu_Too Little</span><span class="st">`</span>,</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>         <span class="at">sd_2 =</span> <span class="st">`</span><span class="at">sd_edu_Too Much</span><span class="st">`</span>)</span></code></pre></div>
<p><br />
</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="co"># year of education distribution plots</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(educ))<span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>natspac, <span class="at">ncol =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Supporting space funding by yrs of education&quot;</span>,</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">&quot;(US in 2010-2012, sample size = 1028)&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Years of education&quot;</span>)<span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>  )</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(educ))<span class="sc">+</span></span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>natspac, <span class="at">ncol =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>) <span class="sc">+</span></span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> educ))<span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()<span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>natspac, <span class="at">nrow =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;QQ Plot for Normal Distribution: Space Spending vs. Education&quot;</span>)<span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Normal theoretical quantile (z-score)&quot;</span>)<span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Data quantile (z-score)&quot;</span>)<span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-43-1.png" width="672" /><br />
The distributions show a relative strong left skew. We like to calculate
the skewness and decide if we can use the samples for the statistical
test.<br />
</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># Calculate skewness for each sub-group</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>gss_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="fu">group_by</span>(natspac) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">skew =</span> <span class="fu">skewness</span>(educ))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   natspac      skew
##   &lt;fct&gt;       &lt;dbl&gt;
## 1 Too Little -0.234
## 2 Too Much   -0.311</code></pre>
<p><br />
The skewness values are between -0.5 and +0.5, i.e. approximately
symmetric distribution. <a
href="https://www.machinelearningplus.com/statistics/skewness-and-kurtosis/">Link</a>.<br />
<br />
</p>
</div>
<div id="a-inference---confidence-interval-2" class="section level4">
<h4>4a) Inference - Confidence Interval</h4>
<p><strong>Check conditions</strong></p>
<p><br />
1. Independence:<br />
</p>
<ul>
<li>random samples within each group: OK<br />
</li>
<li>samples between groups are not paired: OK<br />
</li>
<li>sample size &lt; 10% of population: OK<br />
</li>
</ul>
<p><br />
2. Sample size/ skewness<br />
</p>
<ul>
<li>each sample size is &gt; 30: OK<br />
</li>
<li>skewness is between -0.5 and +0.5, i.e. approx. symmetric: OK<br />
</li>
</ul>
<p>All conditions are met and nearly normal distribution can be assumed.
t-statistic can be applied<br />
<br />
</p>
<p><strong>Calculate confidence interval</strong></p>
<p>Formula:<br />
</p>
<ul>
<li>mean_diff = mean_too_little - mean_too_much<br />
</li>
<li>CI: mean diff +/- t_star * SE<br />
</li>
</ul>
<p>First, we will use the function <code>inference()</code> from the
<code>statsr</code> package, provided for this course.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="do">########################################## statsr::inference() for t.test for CI</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>t_test_CI <span class="ot">&lt;-</span> <span class="fu">inference</span>(<span class="at">y =</span> educ,</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>                       <span class="at">x =</span> natspac,</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>                       <span class="at">data =</span> gss_select2,</span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>                       <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;ci&quot;</span>,</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;theoretical&quot;</span>)</span></code></pre></div>
<pre><code>## Response variable: numerical, Explanatory variable: categorical (2 levels)
## n_Too Little = 372, y_bar_Too Little = 14.5054, s_Too Little = 2.7682
## n_Too Much = 656, y_bar_Too Much = 12.8933, s_Too Much = 3.0916
## 95% CI (Too Little - Too Much): (1.2433 , 1.9809)</code></pre>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p><br />
</p>
<p>Second, confidence interval calculated with base functions.<br />
</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="do">########################################################## manual t.test for CI</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="co"># set significance level</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a><span class="co"># calculate degree of freedom</span></span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a><span class="co"># mean_1 = mean_too_little, mean_2 = mean_too_much</span></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>stat_descript <span class="ot">&lt;-</span> stat_descript <span class="sc">%&gt;%</span> </span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>    <span class="at">mean_diff =</span> mean_1 <span class="sc">-</span> mean_2,</span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>    <span class="at">dof =</span> <span class="fu">min</span>(n_1, n_2) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>    <span class="at">se_ci =</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_1 <span class="sc">+</span> sd_2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n_2),</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>    <span class="at">moe =</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,dof) <span class="sc">*</span> se_ci,</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>    <span class="at">lower =</span> mean_diff <span class="sc">-</span> moe,</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>    <span class="at">upper =</span> mean_diff <span class="sc">+</span> moe)</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a></span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>stat_descript</span></code></pre></div>
<pre><code>## # A tibble: 1 × 12
##     n_1   n_2 mean_1 mean_2  sd_1  sd_2 mean_diff   dof se_ci   moe lower upper
##   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   372   656   14.5   12.9  2.77  3.09      1.61   371 0.188 0.369  1.24  1.98</code></pre>
<p><br />
</p>
<p><strong>Conclusion</strong> We are 95% confident that the true
difference in mean for years in education is between 1.24 and 1.98
years.<br />
I.e. The American public who thinks that the spending for space
exploration is too little have in average 1.24 to 1.98 more years of
education as their counterparts.<br />
<br />
<br />
</p>
</div>
<div id="b-inference---hypothesis-test-2" class="section level4">
<h4>4b) Inference - Hypothesis Test</h4>
<p>Null hypothesis (H0): There is no strong evidence that Americans with
more years in education think that the government spending for space
exploration is too little.<br />
</p>
<p>Alternative hypothesis (Ha): There is a strong evidence that
Americans with more years in education think that the government
spending for space exploration is too little.<br />
</p>
<p>This can be formulated as:<br />
</p>
<ul>
<li>H0: mue_diff = mue_too_little - mue_too_much = 0 (there is no
difference)<br />
</li>
<li>Ha: mue_diff = mue_too_little - mue_too_much &gt; 0 (is greater than
null)<br />
</li>
<li>Significance level: alpha = 0.05 (5%)<br />
<br />
mue: population mean (true mean)<br />
mean: sample mean (estimate of true mean)<br />
<br />
</li>
</ul>
<p>We will carry out a one-sided t-Test<br />
<br />
</p>
<p><strong>Check conditions</strong><br />
</p>
<p><br />
1. Independence:<br />
</p>
<ul>
<li>random samples within each group: OK<br />
</li>
<li>samples between groups are not paired: OK<br />
</li>
<li>sample size &lt; 10% of population: OK<br />
</li>
</ul>
<p><br />
2. Sample size/ skewness<br />
</p>
<ul>
<li>each sample size is &gt; 30: OK<br />
</li>
<li>skewness is between -0.5 and +0.5, i.e. approx. symmetric: OK<br />
</li>
</ul>
<p>All conditions are met and nearly normal distribution can be assumed.
t-statistic can be applied<br />
<br />
</p>
<p><strong>Hypothesis test</strong></p>
<p>First, hypothesis test with function <code>inference()</code> from
<code>statsr</code> package:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="do">########################################## statsr::inference() for t.test for HT</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="co"># Group 1: spending is too little</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a><span class="co"># Group 2: spending is too much</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a><span class="co"># H0: mue_1 - mue_2 = 0 (there is no difference in the true mean)</span></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a><span class="co"># Ha: mue_1 - mue_2 &gt; 0 (mue_1 is greater than mue_2)</span></span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>t_test_HT <span class="ot">&lt;-</span> <span class="fu">inference</span>(<span class="at">y =</span> educ,</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>                       <span class="at">x =</span> natspac,</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>                       <span class="at">data =</span> gss_select2,</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>                       <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;ht&quot;</span>,</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>                       <span class="at">null =</span> <span class="dv">0</span>,</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>                       <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>,</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;theoretical&quot;</span>)</span></code></pre></div>
<pre><code>## Response variable: numerical
## Explanatory variable: categorical (2 levels) 
## n_Too Little = 372, y_bar_Too Little = 14.5054, s_Too Little = 2.7682
## n_Too Much = 656, y_bar_Too Much = 12.8933, s_Too Much = 3.0916
## H0: mu_Too Little =  mu_Too Much
## HA: mu_Too Little &gt; mu_Too Much
## t = 8.5961, df = 371
## p_value = &lt; 0.0001</code></pre>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-47-1.png" width="672" /><br />
<br />
</p>
<p>Second, hypothesis test with base functions.<br />
</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="do">########################################################## manual t.test for HT</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="co"># set the null value</span></span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>null_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a><span class="co"># hypothesis test</span></span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>stat_descript <span class="ot">&lt;-</span> stat_descript <span class="sc">%&gt;%</span> </span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>    <span class="at">t =</span> (mean_diff <span class="sc">-</span> null_value)<span class="sc">/</span>se_ci,</span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>    <span class="at">p_value =</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t), dof)),</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>    <span class="at">test_result =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha, <span class="st">&quot;Reject H0&quot;</span>, <span class="st">&quot;Fail to reject H0&quot;</span>)</span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>  )</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a></span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>stat_descript <span class="sc">%&gt;%</span> </span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>  <span class="fu">select</span>(n_1, mean_1, sd_1,</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>         n_2, mean_2, sd_2,</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>         dof, t, p_value,</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>         test_result)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 10
##     n_1 mean_1  sd_1   n_2 mean_2  sd_2   dof     t  p_value test_result
##   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      
## 1   372   14.5  2.77   656   12.9  3.09   371  8.60 1.11e-16 Reject H0</code></pre>
<p><br />
<strong>Conclusion</strong> The data show a strong evidence that
Americans with more years in education think that the government
spending for space exploration is too little. The p-value is &lt;
0.0001. I.e. the probability to observe a t-value of 8.60 or more
extreme, given that the null hypothesis is true, is almost zero.<br />
The results of the confidence interval and hypothesis tests agree with
each other. I.e a “Reject H0” result corresponds to a confidence
interval that does not include the value “zero”.<br />
<br />
<br />
</p>
<p><br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="anova-test" class="section level3">
<h3>5. ANOVA Test</h3>
<div
id="research-question-5-number-of-children-per-respondent-compared-by-social-classes"
class="section level4">
<h4>Research question 5: Number of children per respondent compared by
social classes</h4>
<p>As final example we want to research the number of children per
respondent in different social classes using the GSS survey for year
2012. We assume that the average number of children differs between the
social classes. To proof this claim we will conduct an ANOVA test
(Analysis of Variance).</p>
<p>We will use the following variables:<br />
</p>
<ul>
<li><code>childs</code> (numerical): Number of children, response
variable<br />
</li>
<li><code>class</code> (categorical, 5 levels): Subjective class
identification, explanatory variable<br />
</li>
</ul>
<p>Tasks:<br />
</p>
<p>Does the data provide strong evidence that there is a difference in
the average number of children per respondent between social classes. In
case that the ANOVA test rejects the Null Hypothesis (there is a
difference at least in one pair), identify which pairs of social classes
are significantly different in their means. Apply a <strong>hypothesis
test (ANOVA test)</strong> with a significance level of 5%.<br />
<br />
</p>
</div>
<div id="exploratory-data-analysis-eda-4" class="section level4">
<h4>Exploratory data analysis (EDA)</h4>
<p><strong>Prepare the data set</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="do">############################################################# Prepare data set</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="co"># ----------------------------------------------------------- select variables</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span> </span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>  <span class="fu">select</span>(year, childs, class) <span class="sc">%&gt;%</span> </span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(childs), <span class="sc">!</span><span class="fu">is.na</span>(class))</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a><span class="co"># ------------------------------------------------------------ Filter for 2012</span></span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2012</span>))</span></code></pre></div>
<p><br />
</p>
<p>Check levels in variable <code>class</code></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="do">################################################################ Check levels</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a><span class="co"># -------------------------------------------------------------- Check levels</span></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>  <span class="fu">group_by</span>(year, class) <span class="sc">%&gt;%</span> </span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
## # Groups:   year, class [4]
##    year class             n
##   &lt;int&gt; &lt;fct&gt;         &lt;int&gt;
## 1  2012 Lower Class     200
## 2  2012 Working Class   852
## 3  2012 Middle Class    837
## 4  2012 Upper Class      65</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co"># ------------------------------------------------------- remove level No Class</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>gss_select <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>   <span class="fu">filter</span>(class <span class="sc">!=</span> <span class="st">&quot;No Class&quot;</span>)</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="co"># ------------------------------------------------------- reset level number</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>gss_select<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(gss_select<span class="sc">$</span>class)</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>Check conditions for ANOVA test</strong><br />
</p>
<p><br />
1. Independence<br />
</p>
<ul>
<li>within each group: random samples: OK<br />
</li>
<li>between groups: non paired: OK<br />
</li>
<li>n &lt; 10% of population: OK<br />
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Approx. normal distribution<br />
</li>
</ol>
<ul>
<li>Check normal distribution and skewness<br />
</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="do">############################################################ check distributions</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a><span class="co"># --------------------------------------------------------------- histogram</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>childs)) <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">binwidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">nrow=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Children per Class (2012)&quot;</span>)<span class="sc">+</span></span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)<span class="sc">+</span></span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb94-13"><a href="#cb94-13" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span>
<span id="cb94-14"><a href="#cb94-14" tabindex="-1"></a></span>
<span id="cb94-15"><a href="#cb94-15" tabindex="-1"></a><span class="co"># ---------------------------------------------------------------- boxplots</span></span>
<span id="cb94-16"><a href="#cb94-16" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb94-17"><a href="#cb94-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>childs))<span class="sc">+</span></span>
<span id="cb94-18"><a href="#cb94-18" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb94-19"><a href="#cb94-19" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">nrow =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb94-20"><a href="#cb94-20" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb94-21"><a href="#cb94-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>) <span class="sc">+</span></span>
<span id="cb94-22"><a href="#cb94-22" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of children per respondent&quot;</span>)<span class="sc">+</span></span>
<span id="cb94-23"><a href="#cb94-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb94-24"><a href="#cb94-24" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb94-25"><a href="#cb94-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb94-26"><a href="#cb94-26" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb94-27"><a href="#cb94-27" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span>
<span id="cb94-28"><a href="#cb94-28" tabindex="-1"></a></span>
<span id="cb94-29"><a href="#cb94-29" tabindex="-1"></a></span>
<span id="cb94-30"><a href="#cb94-30" tabindex="-1"></a>plot1 <span class="sc">/</span> plot2</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-52-1.png" width="672" /><br />
</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------- qq plots</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> childs))<span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>()<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">nrow =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;QQ Plot for Normal Distribution: Children per Class&quot;</span>)<span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Normal theoretical quantile (z-score)&quot;</span>)<span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Data quantile (z-score)&quot;</span>)<span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-53-1.png" width="672" /><br />
</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># -------------------------------------------------------- Skewness</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> </span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>            <span class="at">skew =</span> <span class="fu">skewness</span>(childs))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   class             n  skew
##   &lt;fct&gt;         &lt;int&gt; &lt;dbl&gt;
## 1 Lower Class     200 1.01 
## 2 Working Class   852 0.953
## 3 Middle Class    837 0.914
## 4 Upper Class      65 0.927</code></pre>
<p><br />
</p>
<p>The skewness values are between -1.0 and +1.0, i.e. the distribution
is moderately skewed. <a
href="https://www.machinelearningplus.com/statistics/skewness-and-kurtosis/">Link</a>.
However, there are no large numbers of extreme outliers. Therefore, we
can assume that the variables will hold nearly normal
distribution.<br />
<br />
</p>
<ol start="3" style="list-style-type: decimal">
<li>Consistent variability (<strong>homoscedasticity</strong>)</li>
</ol>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="do">############################################################# Summary statistic</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>sum1 <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> </span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_class =</span> <span class="fu">n</span>(),</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>            <span class="at">mean_class =</span> <span class="fu">mean</span>(childs),</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>            <span class="at">sd_class =</span> <span class="fu">sd</span>(childs))</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>sum1</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
##   class         n_class mean_class sd_class
##   &lt;fct&gt;           &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;
## 1 Lower Class       200       2.28     1.92
## 2 Working Class     852       1.87     1.65
## 3 Middle Class      837       1.80     1.61
## 4 Upper Class        65       2        1.78</code></pre>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="do">################################################################ Boxplots again</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gss_select, <span class="fu">aes</span>(<span class="at">y=</span>childs))<span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">nrow =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of Children per Class (2012)&quot;</span>,</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;General Social Survey (GSS), 1972-2012&quot;</span>) <span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Number of children per respondent&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-56-1.png" width="672" /><br />
</p>
<p>From summary statistic and from the boxplot we can assume that the
variation is sufficiently consistent (sd range 1.60 to 1.92)<br />
</p>
<p>All conditions are met and we can proceed to the ANOVA test.<br />
<br />
<br />
</p>
</div>
<div id="inference---anova-test-and-multiple-comparison-test"
class="section level4">
<h4>Inference - ANOVA Test and Multiple Comparison Test</h4>
<p>Null hypothesis (H0): There is no strong evidence that the average
number of children per respondent differs between social classes.<br />
<br />
Alternative hypothesis (Ha): There is strong evidence that the average
number of children per respondent differs at least between two social
classes.<br />
<br />
</p>
<p>This can be formulated as:<br />
</p>
<ul>
<li>H0: mue_1 = mue_2 = … = mue_k (no difference between true
means)</li>
<li>Ha: mue_i != mue_j (difference between at least two true
means)<br />
</li>
<li>Significance level: alpha = 0.05 (5%)<br />
<br />
</li>
</ul>
<p>mue: population mean (true mean)<br />
mean: sample mean (estimate of true mean)<br />
k: number of classes<br />
</p>
<p>ANOVA and Multiple pairwise test with function
<code>inference()</code> from <code>statsr</code> package:</p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="do">################################################################ ANOVA Test</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="co"># ------------------------------------------------------ calculating alpha_star</span></span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">length</span>(sum1<span class="sc">$</span>class)               <span class="co"># ---------------------- number of classes</span></span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>alpha_star <span class="ot">&lt;-</span> alpha<span class="sc">/</span>(K<span class="sc">*</span>(K<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)       <span class="co"># ---------------------- alpha_star</span></span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;alpha_star (Benferroni correction) = &quot;</span>, <span class="fu">round</span>(alpha_star, <span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;alpha_star (Benferroni correction) = 0.0083&quot;</code></pre>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="co"># ------------------------------------------------------------------ ANOVA Test</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>anova_test <span class="ot">&lt;-</span> <span class="fu">inference</span>(<span class="at">y =</span> childs,</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>                       <span class="at">x =</span> class,</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>                       <span class="at">data =</span> gss_select,</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>                       <span class="at">statistic =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;ht&quot;</span>,</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>                       <span class="at">null =</span> <span class="dv">0</span>,</span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>                       <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>,</span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;theoretical&quot;</span>,</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>                       <span class="at">sig_level =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## Response variable: numerical
## Explanatory variable: categorical (4 levels) 
## n_Lower Class = 200, y_bar_Lower Class = 2.275, s_Lower Class = 1.9151
## n_Working Class = 852, y_bar_Working Class = 1.8709, s_Working Class = 1.6489
## n_Middle Class = 837, y_bar_Middle Class = 1.8029, s_Middle Class = 1.6083
## n_Upper Class = 65, y_bar_Upper Class = 2, s_Upper Class = 1.7766
## 
## ANOVA:
##             df    Sum_Sq Mean_Sq      F p_value
## class        3   37.0841 12.3614 4.4571   0.004
## Residuals 1950 5408.1462  2.7734               
## Total     1953 5445.2303                       
## 
## Pairwise tests - t tests with pooled SD:
## # A tibble: 6 × 3
##   group1        group2         p.value
##   &lt;chr&gt;         &lt;chr&gt;            &lt;dbl&gt;
## 1 Working Class Lower Class   0.00204 
## 2 Middle Class  Lower Class   0.000324
## 3 Middle Class  Working Class 0.401   
## 4 Upper Class   Lower Class   0.248   
## 5 Upper Class   Working Class 0.547   
## 6 Upper Class   Middle Class  0.358</code></pre>
<p><img src="02_stat_inf_project_files/figure-html/unnamed-chunk-57-1.png" width="672" /><br />
<strong>Conclusion 1</strong><br />
</p>
<ul>
<li>The ANOVA test delivers a p-value of 0.004 which is less than alpha
0.05. Therefore, we reject the Null Hypothesis. I.e. there is a strong
evidence that the average number of children per class differs at least
in one pair.<br />
</li>
</ul>
<p><br />
<strong>Conclusion 2:</strong><br />
</p>
<ul>
<li>The multiple pairwise t-test identifies the pairs of classes with
strong evidence of difference in the number of children. In this case we
test against the corrected alpha value (Bonferroni correction,
alpha_star = 0.0083). For the following pairs we don’t have strong
evidence that there is a difference int eht average number of children
per class:<br />
<br />
</li>
</ul>
<p>– Middle Class - Working Class (p-value 0.40 &gt; 0.0083) =&gt; Fail
to reject H0<br />
– Upper Class - Lower Class (p-value 0.25 &gt; 0.0083) =&gt; Fail to
reject H0<br />
– Upper Class - Working Class (p-value 0.55 &gt; 0.0083) =&gt; Fail to
reject H0<br />
– Upper Class - Middle Class (p-value 0.36 &gt; 0.0083) =&gt; Fail to
reject H0<br />
<br />
</p>
<ul>
<li>Only in the pairs “Working Class - Lower Class” and “Middle Class -
Lower Class” we do have a strong evidence that there is a difference in
the average number of children per class.<br />
<br />
<br />
</li>
</ul>
</div>
<div
id="optional-inference---anova-test-and-multiple-comparison-test-alternative-1"
class="section level4">
<h4>OPTIONAL: Inference - ANOVA Test and Multiple Comparison Test
(alternative 1)</h4>
<p>Alternatively, we can also calculate ANOVA and Multiple Comparison
Test with functions from the <code>stats</code> package:<br />
</p>
<ul>
<li><code>aov()</code> for ANOVA test<br />
</li>
<li><code>TukeyHSD()</code> for a modified multiple comparison
test<br />
</li>
</ul>
<p><em>For more information see Help function in RStudio.</em><br />
</p>
<div class="sourceCode" id="cb105"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="do">### ANOVA Test (Alternative approach) ##########################################</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a><span class="co"># H0: average number of children per respondent is the same across all social classes</span></span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a><span class="co"># Ha: average number of children per respondent is not the same across all social classes,</span></span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a><span class="co"># at least not between two groups</span></span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a>gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>  <span class="fu">aov</span>(childs <span class="sc">~</span> class, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## class          3     37  12.361   4.457 0.00398 **
## Residuals   1950   5408   2.773                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><br />
We get the identical result as from function
<code>inference</code>.<br />
</p>
<p>A common post-hoc test (after test) for ANOVA is the <a
href="https://en.wikipedia.org/wiki/Tukey%27s_range_test">TukeyHSD
test</a><br />
</p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="do">### Post-hoc ANOVA TukeyHSD test ##############################################</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> gss_select <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="fu">aov</span>(childs <span class="sc">~</span> class, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  <span class="fu">TukeyHSD</span>()</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>model</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = childs ~ class, data = .)
## 
## $class
##                                   diff        lwr         upr     p adj
## Working Class-Lower Class  -0.40410798 -0.7405606 -0.06765532 0.0109810
## Middle Class-Lower Class   -0.47213262 -0.8091579 -0.13510729 0.0018372
## Upper Class-Lower Class    -0.27500000 -0.8863672  0.33636722 0.6543625
## Middle Class-Working Class -0.06802464 -0.2764177  0.14036839 0.8357024
## Upper Class-Working Class   0.12910798 -0.4219015  0.68011748 0.9313006
## Upper Class-Middle Class    0.19713262 -0.3542267  0.74849198 0.7945317</code></pre>
<p>The p-values from the TukeyHSD tests are adjusted p-values.<br />
<br />
<br />
<br />
<br />
</p>
</div>
<div
id="optional-inference---anova-test-and-multiple-comparison-test-alternative-2"
class="section level4">
<h4>OPTIONAL: Inference - ANOVA Test and Multiple Comparison Test
(alternative 2)</h4>
<p>Both ANOVA test functions are more or less a kind of “blackboxes”.
Below we wrote a code to manually calculate ANOVA and the multiple
comparison t-test.<br />
</p>
<p><strong>ANOVA Test</strong></p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="do">########################################################## ANOVA Test (manually)</span></span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>sum1</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
##   class         n_class mean_class sd_class
##   &lt;fct&gt;           &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;
## 1 Lower Class       200       2.28     1.92
## 2 Working Class     852       1.87     1.65
## 3 Middle Class      837       1.80     1.61
## 4 Upper Class        65       2        1.78</code></pre>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co"># --------------------------------------------------- Number of obs. and groups</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(gss_select<span class="sc">$</span>childs)                       <span class="co"># --- total # observations</span></span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">length</span>(sum1<span class="sc">$</span>class)                              <span class="co"># --------------- # groups</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a><span class="co"># ------------- Calculate SSE (sum squared errors) and MSE (mean squared errors)</span></span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((sum1<span class="sc">$</span>n_class <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sum1<span class="sc">$</span>sd_class<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>dfe <span class="ot">&lt;-</span> N <span class="sc">-</span> K                                          <span class="co"># ----- degree of freedom</span></span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> SSE<span class="sc">/</span>dfe</span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a></span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a><span class="co"># --------------------------------------------- Calculate SST (sum squared total)</span></span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a>mean_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(gss_select<span class="sc">$</span>childs)<span class="sc">/</span>N</span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((gss_select<span class="sc">$</span>childs <span class="sc">-</span> mean_total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>df <span class="ot">&lt;-</span> N <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a></span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a><span class="co"># ------------- Calculate SSG (sum squared groups) and MSG (mean squared groups)</span></span>
<span id="cb111-18"><a href="#cb111-18" tabindex="-1"></a>SSG <span class="ot">&lt;-</span> <span class="fu">sum</span>(sum1<span class="sc">$</span>n_class <span class="sc">*</span> (sum1<span class="sc">$</span>mean_class <span class="sc">-</span> mean_total)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb111-19"><a href="#cb111-19" tabindex="-1"></a>dfg <span class="ot">&lt;-</span> K <span class="sc">-</span> <span class="dv">1</span>                                           <span class="co"># ----- degree of freedom</span></span>
<span id="cb111-20"><a href="#cb111-20" tabindex="-1"></a>MSG <span class="ot">&lt;-</span> SSG<span class="sc">/</span>dfg</span>
<span id="cb111-21"><a href="#cb111-21" tabindex="-1"></a></span>
<span id="cb111-22"><a href="#cb111-22" tabindex="-1"></a><span class="co"># Check sum</span></span>
<span id="cb111-23"><a href="#cb111-23" tabindex="-1"></a>SST2 <span class="ot">&lt;-</span> SSG <span class="sc">+</span> SSE</span>
<span id="cb111-24"><a href="#cb111-24" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> dfe <span class="sc">+</span> dfg</span>
<span id="cb111-25"><a href="#cb111-25" tabindex="-1"></a></span>
<span id="cb111-26"><a href="#cb111-26" tabindex="-1"></a><span class="co"># print(paste0(&quot;Check sum for Sum Squared: SST = SSE + SSG : &quot;, near(SST, SST2)))</span></span>
<span id="cb111-27"><a href="#cb111-27" tabindex="-1"></a><span class="co"># print(paste0(&quot;Check sum for degrees of freedom:  df = dfe + dfg : &quot;, near(df, df2)))</span></span>
<span id="cb111-28"><a href="#cb111-28" tabindex="-1"></a></span>
<span id="cb111-29"><a href="#cb111-29" tabindex="-1"></a></span>
<span id="cb111-30"><a href="#cb111-30" tabindex="-1"></a><span class="co"># ---------------------------------------------------------------------- F.Test</span></span>
<span id="cb111-31"><a href="#cb111-31" tabindex="-1"></a>F <span class="ot">&lt;-</span> MSG<span class="sc">/</span>MSE</span>
<span id="cb111-32"><a href="#cb111-32" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">pf</span>(F, dfg, dfe, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb111-33"><a href="#cb111-33" tabindex="-1"></a></span>
<span id="cb111-34"><a href="#cb111-34" tabindex="-1"></a><span class="co"># --------------------------------------------------------------- Output table</span></span>
<span id="cb111-35"><a href="#cb111-35" tabindex="-1"></a></span>
<span id="cb111-36"><a href="#cb111-36" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">c</span>(dfg, SSG, MSG, F, p_value)        <span class="co"># ------- vector for results groups</span></span>
<span id="cb111-37"><a href="#cb111-37" tabindex="-1"></a>Residuals <span class="ot">&lt;-</span> <span class="fu">c</span>(dfe, SSE, MSE, <span class="cn">NA</span>, <span class="cn">NA</span>)        <span class="co"># ------- vector for results error</span></span>
<span id="cb111-38"><a href="#cb111-38" tabindex="-1"></a>Total <span class="ot">&lt;-</span> <span class="fu">c</span>(df, SST, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)              <span class="co"># ------- vector for results total</span></span>
<span id="cb111-39"><a href="#cb111-39" tabindex="-1"></a></span>
<span id="cb111-40"><a href="#cb111-40" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">cbind</span>(class, Residuals, Total)     <span class="co"># ------- bind to dataframe</span></span>
<span id="cb111-41"><a href="#cb111-41" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">t</span>(output)                          <span class="co"># ------- transpose</span></span>
<span id="cb111-42"><a href="#cb111-42" tabindex="-1"></a></span>
<span id="cb111-43"><a href="#cb111-43" tabindex="-1"></a><span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;df&quot;</span>, <span class="st">&quot;Sum_sq&quot;</span>, <span class="st">&quot;Mean_sq&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;p_value&quot;</span>) <span class="co">#  add colnames</span></span>
<span id="cb111-44"><a href="#cb111-44" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##             df     Sum_sq   Mean_sq        F     p_value
## class        3   37.08406 12.361352 4.457098 0.003976408
## Residuals 1950 5408.14624  2.773408       NA          NA
## Total     1953 5445.23030        NA       NA          NA</code></pre>
<p>Identical result as in other approaches.<br />
<br />
<br />
</p>
<p><strong>Multiple Comparison Test</strong></p>
<p>Create a table for each group pair by combinatorics without
repetition</p>
<div class="sourceCode" id="cb113"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="do">########  Create combination table for all Groups without repetition ########</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="co"># change factor to character</span></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>sum1<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">as.character</span>(sum1<span class="sc">$</span>class)</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a><span class="co"># create combination array</span></span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>dfc <span class="ot">&lt;-</span> <span class="fu">combn</span>(sum1<span class="sc">$</span>class,<span class="dv">2</span>)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>dfc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfc)</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a><span class="co"># Transpose dataframe</span></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>dfc_t <span class="ot">&lt;-</span> <span class="fu">t</span>(dfc)</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>dfc_t <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfc_t)</span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a></span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a><span class="co"># Rename name of column</span></span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>dfc_t_left <span class="ot">&lt;-</span> dfc_t <span class="sc">%&gt;%</span> </span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">&quot;class&quot;</span> <span class="ot">=</span> <span class="st">&quot;V1&quot;</span>))</span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a>dfc_t_right <span class="ot">&lt;-</span> dfc_t <span class="sc">%&gt;%</span> </span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">&quot;class&quot;</span> <span class="ot">=</span> <span class="st">&quot;V2&quot;</span>))</span>
<span id="cb113-19"><a href="#cb113-19" tabindex="-1"></a></span>
<span id="cb113-20"><a href="#cb113-20" tabindex="-1"></a><span class="co"># Join with dataframe sum1 (for values)</span></span>
<span id="cb113-21"><a href="#cb113-21" tabindex="-1"></a>df_joint_left <span class="ot">&lt;-</span> dfc_t_left <span class="sc">%&gt;%</span> </span>
<span id="cb113-22"><a href="#cb113-22" tabindex="-1"></a>  <span class="fu">left_join</span>(sum1, <span class="at">by =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb113-23"><a href="#cb113-23" tabindex="-1"></a></span>
<span id="cb113-24"><a href="#cb113-24" tabindex="-1"></a>df_joint_right <span class="ot">&lt;-</span> dfc_t_right <span class="sc">%&gt;%</span> </span>
<span id="cb113-25"><a href="#cb113-25" tabindex="-1"></a>  <span class="fu">left_join</span>(sum1, <span class="at">by =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb113-26"><a href="#cb113-26" tabindex="-1"></a></span>
<span id="cb113-27"><a href="#cb113-27" tabindex="-1"></a><span class="co"># Add row ID and rename columns (left)</span></span>
<span id="cb113-28"><a href="#cb113-28" tabindex="-1"></a>df_joint_left <span class="ot">&lt;-</span> df_joint_left <span class="sc">%&gt;%</span> </span>
<span id="cb113-29"><a href="#cb113-29" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb113-30"><a href="#cb113-30" tabindex="-1"></a></span>
<span id="cb113-31"><a href="#cb113-31" tabindex="-1"></a>df_joint_left <span class="ot">&lt;-</span> df_joint_left <span class="sc">%&gt;%</span> </span>
<span id="cb113-32"><a href="#cb113-32" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">&quot;V1&quot;</span> <span class="ot">=</span> <span class="st">&quot;class&quot;</span>))</span>
<span id="cb113-33"><a href="#cb113-33" tabindex="-1"></a></span>
<span id="cb113-34"><a href="#cb113-34" tabindex="-1"></a><span class="co"># Add row ID and rename columns (right)</span></span>
<span id="cb113-35"><a href="#cb113-35" tabindex="-1"></a>df_joint_right <span class="ot">&lt;-</span> df_joint_right <span class="sc">%&gt;%</span> </span>
<span id="cb113-36"><a href="#cb113-36" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb113-37"><a href="#cb113-37" tabindex="-1"></a></span>
<span id="cb113-38"><a href="#cb113-38" tabindex="-1"></a>df_joint_right <span class="ot">&lt;-</span> df_joint_right <span class="sc">%&gt;%</span> </span>
<span id="cb113-39"><a href="#cb113-39" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="fu">c</span>(<span class="st">&quot;V2&quot;</span> <span class="ot">=</span> <span class="st">&quot;class&quot;</span>))</span>
<span id="cb113-40"><a href="#cb113-40" tabindex="-1"></a></span>
<span id="cb113-41"><a href="#cb113-41" tabindex="-1"></a><span class="co"># Join left and right tables by ID</span></span>
<span id="cb113-42"><a href="#cb113-42" tabindex="-1"></a>df_joint_total <span class="ot">&lt;-</span> df_joint_left <span class="sc">%&gt;%</span> </span>
<span id="cb113-43"><a href="#cb113-43" tabindex="-1"></a>  <span class="fu">inner_join</span>(df_joint_right, <span class="at">by =</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb113-44"><a href="#cb113-44" tabindex="-1"></a></span>
<span id="cb113-45"><a href="#cb113-45" tabindex="-1"></a><span class="co"># Clean up</span></span>
<span id="cb113-46"><a href="#cb113-46" tabindex="-1"></a>sum1_combi <span class="ot">&lt;-</span> df_joint_total <span class="sc">%&gt;%</span> </span>
<span id="cb113-47"><a href="#cb113-47" tabindex="-1"></a>  <span class="fu">select</span>(id, </span>
<span id="cb113-48"><a href="#cb113-48" tabindex="-1"></a>         <span class="at">class.x =</span> <span class="st">&quot;V1.x&quot;</span>, </span>
<span id="cb113-49"><a href="#cb113-49" tabindex="-1"></a>         <span class="at">class.y =</span> <span class="st">&quot;V2.y&quot;</span>,         </span>
<span id="cb113-50"><a href="#cb113-50" tabindex="-1"></a>         n_class.x,</span>
<span id="cb113-51"><a href="#cb113-51" tabindex="-1"></a>         mean_class.x,</span>
<span id="cb113-52"><a href="#cb113-52" tabindex="-1"></a>         sd_class.x,</span>
<span id="cb113-53"><a href="#cb113-53" tabindex="-1"></a>         n_class.y,</span>
<span id="cb113-54"><a href="#cb113-54" tabindex="-1"></a>         mean_class.y,</span>
<span id="cb113-55"><a href="#cb113-55" tabindex="-1"></a>         sd_class.y)</span>
<span id="cb113-56"><a href="#cb113-56" tabindex="-1"></a></span>
<span id="cb113-57"><a href="#cb113-57" tabindex="-1"></a><span class="fu">rm</span>(df_joint_left, df_joint_right, dfc, dfc_t, dfc_t_left, dfc_t_right)</span>
<span id="cb113-58"><a href="#cb113-58" tabindex="-1"></a></span>
<span id="cb113-59"><a href="#cb113-59" tabindex="-1"></a><span class="co"># Summary table for pairwise testing of all possible combinations</span></span>
<span id="cb113-60"><a href="#cb113-60" tabindex="-1"></a>sum1_combi</span></code></pre></div>
<pre><code>##   id       class.x       class.y n_class.x mean_class.x sd_class.x n_class.y
## 1  1   Lower Class Working Class       200     2.275000   1.915128       852
## 2  2   Lower Class  Middle Class       200     2.275000   1.915128       837
## 3  3   Lower Class   Upper Class       200     2.275000   1.915128        65
## 4  4 Working Class  Middle Class       852     1.870892   1.648914       837
## 5  5 Working Class   Upper Class       852     1.870892   1.648914        65
## 6  6  Middle Class   Upper Class       837     1.802867   1.608319        65
##   mean_class.y sd_class.y
## 1     1.870892   1.648914
## 2     1.802867   1.608319
## 3     2.000000   1.776584
## 4     1.802867   1.608319
## 5     2.000000   1.776584
## 6     2.000000   1.776584</code></pre>
<p><br />
</p>
<p>Multiple t-tests<br />
</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="do">################## Multiple combination t-test ################################</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a><span class="co"># ------------------------------------------------------- Bonferroni correction</span></span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>alpha_star <span class="ot">&lt;-</span> alpha<span class="sc">/</span>(K<span class="sc">*</span>(K<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a><span class="co"># --------------------------- Calculate for each combination, SE, t and p_value</span></span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>sum1_combi2 <span class="ot">&lt;-</span> sum1_combi <span class="sc">%&gt;%</span> </span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_diff =</span> mean_class.x <span class="sc">-</span> mean_class.y,</span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a>         <span class="at">SE =</span> <span class="fu">sqrt</span>(MSE<span class="sc">/</span>n_class.x <span class="sc">+</span> MSE<span class="sc">/</span>n_class.y),</span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a>         <span class="at">T =</span> mean_diff <span class="sc">/</span> SE,</span>
<span id="cb115-12"><a href="#cb115-12" tabindex="-1"></a>         <span class="at">p_value =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fu">abs</span>(T),dfe, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb115-13"><a href="#cb115-13" tabindex="-1"></a>         <span class="at">result =</span> <span class="fu">ifelse</span>(p_value <span class="sc">&lt;</span> alpha_star, </span>
<span id="cb115-14"><a href="#cb115-14" tabindex="-1"></a>                         <span class="st">&quot;Reject H0&quot;</span>, </span>
<span id="cb115-15"><a href="#cb115-15" tabindex="-1"></a>                         <span class="st">&quot;Fail to reject H0&quot;</span>))</span>
<span id="cb115-16"><a href="#cb115-16" tabindex="-1"></a></span>
<span id="cb115-17"><a href="#cb115-17" tabindex="-1"></a>sum1_combi2_short <span class="ot">&lt;-</span> sum1_combi2 <span class="sc">%&gt;%</span> </span>
<span id="cb115-18"><a href="#cb115-18" tabindex="-1"></a>  <span class="fu">select</span>(id,</span>
<span id="cb115-19"><a href="#cb115-19" tabindex="-1"></a>         class.x,</span>
<span id="cb115-20"><a href="#cb115-20" tabindex="-1"></a>         class.y,</span>
<span id="cb115-21"><a href="#cb115-21" tabindex="-1"></a>         mean_diff,</span>
<span id="cb115-22"><a href="#cb115-22" tabindex="-1"></a>         SE,</span>
<span id="cb115-23"><a href="#cb115-23" tabindex="-1"></a>         T,</span>
<span id="cb115-24"><a href="#cb115-24" tabindex="-1"></a>         p_value,</span>
<span id="cb115-25"><a href="#cb115-25" tabindex="-1"></a>         result)</span>
<span id="cb115-26"><a href="#cb115-26" tabindex="-1"></a>sum1_combi2_short</span></code></pre></div>
<pre><code>##   id       class.x       class.y   mean_diff         SE          T      p_value
## 1  1   Lower Class Working Class  0.40410798 0.13085188  3.0882855 0.0020415248
## 2  2   Lower Class  Middle Class  0.47213262 0.13107461  3.6020144 0.0003236652
## 3  3   Lower Class   Upper Class  0.27500000 0.23777061  1.1565769 0.2475869203
## 4  4 Working Class  Middle Class  0.06802464 0.08104742  0.8393189 0.4013932479
## 5  5 Working Class   Upper Class -0.12910798 0.21429651 -0.6024736 0.5469290104
## 6  6  Middle Class   Upper Class -0.19713262 0.21443258 -0.9193221 0.3580408059
##              result
## 1         Reject H0
## 2         Reject H0
## 3 Fail to reject H0
## 4 Fail to reject H0
## 5 Fail to reject H0
## 6 Fail to reject H0</code></pre>
<div class="sourceCode" id="cb117"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;modified significance level, alpha_star: &quot;</span>, <span class="fu">round</span>(alpha_star,<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;modified significance level, alpha_star: 0.0083&quot;</code></pre>
<p><br />
The results are identical with the results from function
<code>inference</code>.</p>
<p><br />
</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
